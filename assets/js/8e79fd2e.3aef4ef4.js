"use strict";(globalThis.webpackChunkbook_site=globalThis.webpackChunkbook_site||[]).push([[2079],{834:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>s});var t=i(6540);const o={},r=t.createContext(o);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(r.Provider,{value:n},e.children)}},8625:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"learning and intelligence/reinforcement-learning","title":"Chapter 6 \u2013 Reinforcement Learning in the Real World","description":"Reinforcement Learning in the Real World","source":"@site/docs/2-learning and intelligence/06-reinforcement-learning.md","sourceDirName":"2-learning and intelligence","slug":"/chapters/06-reinforcement-learning","permalink":"/docs/chapters/06-reinforcement-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2-learning and intelligence/06-reinforcement-learning.md","tags":[{"inline":true,"label":"rl","permalink":"/docs/tags/rl"},{"inline":true,"label":"sim2real","permalink":"/docs/tags/sim-2-real"},{"inline":true,"label":"domain-randomization","permalink":"/docs/tags/domain-randomization"},{"inline":true,"label":"humanoid","permalink":"/docs/tags/humanoid"}],"version":"current","sidebarPosition":6,"frontMatter":{"slug":"/chapters/06-reinforcement-learning","sidebar_position":6,"title":"Chapter 6 \u2013 Reinforcement Learning in the Real World","tags":["rl","sim2real","domain-randomization","humanoid"]},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 5 \u2013 Imitation Learning and Data Collection at Scale","permalink":"/docs/chapters/05-imitation-learning-data-scale"},"next":{"title":"Chapter 7 \u2013 Foundation Models Meet Robotics","permalink":"/docs/chapters/07-foundation-models"}}');var o=i(4848),r=i(834);const a={slug:"/chapters/06-reinforcement-learning",sidebar_position:6,title:"Chapter 6 \u2013 Reinforcement Learning in the Real World",tags:["rl","sim2real","domain-randomization","humanoid"]},s="Part II \u2013 Learning and Intelligence",l={},c=[{value:"Introduction: Learning Through Trial and Error",id:"introduction-learning-through-trial-and-error",level:2},{value:"Fundamentals of Reinforcement Learning",id:"fundamentals-of-reinforcement-learning",level:2},{value:"Key Concepts",id:"key-concepts",level:3},{value:"Core Algorithms",id:"core-algorithms",level:3},{value:"Challenges of RL in the Real World",id:"challenges-of-rl-in-the-real-world",level:2},{value:"Sim-to-Real Transfer: Bridging the Reality Gap",id:"sim-to-real-transfer-bridging-the-reality-gap",level:2},{value:"Simulators for Robotics",id:"simulators-for-robotics",level:3},{value:"Techniques for Sim-to-Real Transfer",id:"techniques-for-sim-to-real-transfer",level:3},{value:"Real-World RL for Humanoid Robots",id:"real-world-rl-for-humanoid-robots",level:2},{value:"Conclusion: Autonomous Skill Acquisition",id:"conclusion-autonomous-skill-acquisition",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"part-ii--learning-and-intelligence",children:"Part II \u2013 Learning and Intelligence"})}),"\n",(0,o.jsx)(n.h1,{id:"chapter-6",children:"Chapter 6"}),"\n",(0,o.jsx)(n.p,{children:"Reinforcement Learning in the Real World"}),"\n",(0,o.jsx)(n.h2,{id:"introduction-learning-through-trial-and-error",children:"Introduction: Learning Through Trial and Error"}),"\n",(0,o.jsxs)(n.p,{children:["Imagine a child learning to walk. They stumble, fall, and slowly, through repeated attempts and feedback from their environment, learn to balance and coordinate their movements. This process of learning through interaction and receiving rewards or penalties is the essence of ",(0,o.jsx)(n.strong,{children:"Reinforcement Learning (RL)"}),". In Physical AI, RL offers a powerful paradigm for robots to acquire complex behaviors autonomously, especially when explicit programming is difficult or when the environment is uncertain and dynamic."]}),"\n",(0,o.jsx)(n.p,{children:"Unlike supervised learning (as seen in imitation learning), RL does not rely on labeled datasets of expert demonstrations. Instead, an RL agent learns an optimal policy\u2014a mapping from states to actions\u2014by maximizing a cumulative reward signal. This chapter explores the fundamentals of reinforcement learning, its application to physical robots, and crucial techniques like Sim-to-Real transfer and domain randomization that bridge the gap between simulated training and real-world deployment. We will also discuss the unique challenges and future directions for RL in the context of embodied intelligence."}),"\n",(0,o.jsx)(n.h2,{id:"fundamentals-of-reinforcement-learning",children:"Fundamentals of Reinforcement Learning"}),"\n",(0,o.jsxs)(n.p,{children:["Reinforcement learning involves an agent interacting with an environment over a sequence of time steps. At each step, the agent observes the current state (s_t), takes an action (a_t), and receives a reward ($r_t$) from the environment. The action transitions the environment to a new state  (",(0,o.jsx)(n.code,{children:"s_t"}),"), The agent's goal is to learn a policy \\pi(a|s) that maximizes the expected cumulative reward over time."]}),"\n",(0,o.jsx)(n.h3,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Agent"}),": The learner and decision-maker (e.g., the robot)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Environment"}),": Everything outside the agent that it interacts with (e.g., the physical world, objects, gravity)."]}),"\n",(0,o.jsx)(n.li,{children:"**State (s_t) complete description of the environment at a given time (e.g., joint angles, sensor readings, object positions)."}),"\n",(0,o.jsx)(n.li,{children:"**Action (a_t) A decision made by the agent that affects the environment (e.g., motor commands, gripper movements)."}),"\n",(0,o.jsx)(n.li,{children:"**Reward (r_t) A scalar feedback signal from the environment, indicating the desirability of the agent's action. The design of effective reward functions is critical."}),"\n",(0,o.jsx)(n.li,{children:"Policy (\u03c0(a|s)): The robot\u2019s strategy for choosing moves."}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsxs)(n.strong,{children:["Value Function (",(0,o.jsx)(n.code,{children:"V(s)"})," or ",(0,o.jsx)(n.code,{children:"Q(s, a)"}),")"]}),": Predicts the expected future reward from a given state or state-action pair."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"core-algorithms",children:"Core Algorithms"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Model-Free vs. Model-Based RL"}),": Model-free algorithms learn directly from experience without building an explicit model of the environment dynamics. Model-based algorithms, in contrast, learn or use a model of how the environment works to plan or improve policies."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Value-Based Methods (e.g., Q-learning, SARSA)"}),": Learn an optimal value function, and the policy is derived from it. Suitable for discrete action spaces."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Policy-Based Methods (e.g., REINFORCE, Actor-Critic)"}),": Directly learn the policy. Often preferred for continuous action spaces common in robotics."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Deep Reinforcement Learning (DRL)"}),": Combines deep neural networks with RL algorithms, allowing agents to learn complex policies directly from high-dimensional raw sensory inputs (e.g., camera images). Deep Q-Networks (DQN), Proximal Policy Optimization (PPO), and Soft Actor-Critic (SAC) are popular DRL algorithms."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"challenges-of-rl-in-the-real-world",children:"Challenges of RL in the Real World"}),"\n",(0,o.jsx)(n.p,{children:"While powerful, applying RL directly to physical robots presents significant challenges compared to simulated environments:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Sample Efficiency"}),": Real-world interactions are slow, costly, and potentially damaging. RL often requires a vast number of trials to learn, making it impractical for physical robots."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Safety"}),": Random exploration, essential for RL, can lead to unsafe actions that damage the robot or its surroundings."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Reward Design"}),": Crafting an effective reward function that accurately reflects the desired behavior without leading to unintended consequences (reward hacking) is notoriously difficult."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"High-Dimensional State and Action Spaces"}),": Physical robots often have many joints and complex sensor inputs, leading to high-dimensional control problems."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Partial Observability"}),": Robots may not have a complete view of the environment, making it challenging to determine the true state."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"The Reality Gap"}),": Differences between simulation and the real world (e.g., friction, sensor noise, actuator dynamics) can prevent policies learned in simulation from working on physical robots."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"sim-to-real-transfer-bridging-the-reality-gap",children:"Sim-to-Real Transfer: Bridging the Reality Gap"}),"\n",(0,o.jsxs)(n.p,{children:["To overcome the sample efficiency and safety challenges of real-world RL, ",(0,o.jsx)(n.strong,{children:"Sim-to-Real transfer"})," has become a crucial methodology. Policies are learned in high-fidelity simulators and then transferred to physical robots."]}),"\n",(0,o.jsx)(n.h3,{id:"simulators-for-robotics",children:"Simulators for Robotics"}),"\n",(0,o.jsx)(n.p,{children:"Robotics simulators (e.g., MuJoCo, Isaac Gym, Gazebo, PyBullet) provide a safe, fast, and cost-effective environment for RL training. They offer:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Physics Engines"}),": Model rigid body dynamics, contact forces, and gravity."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Sensor Emulation"}),": Simulate camera images, depth sensors, force sensors, etc."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Fast Iteration"}),": Allow for rapid parallel training of many agents or many copies of the same agent."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"techniques-for-sim-to-real-transfer",children:"Techniques for Sim-to-Real Transfer"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Domain Randomization (DR)"}),": The most widely used technique, DR involves randomizing various physical parameters of the simulation (e.g., friction coefficients, object masses, sensor noise, lighting, textures) during training. By exposing the agent to a wide distribution of environments in simulation, the learned policy becomes more robust and generalizes better to the uncertainties and variations of the real world. The hope is that the real world will appear as just another variation within the randomized simulated environments."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Domain Adaptation"}),": Techniques that attempt to adapt a policy learned in simulation to the target real-world domain. This can involve fine-tuning the policy with a small amount of real-world data or using adversarial methods to make the simulated and real-world observations indistinguishable."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"System Identification"}),": Accurately measuring and modeling the physical parameters of the real robot (e.g., mass, inertia, joint stiffness, sensor noise characteristics) and incorporating these into the simulator to reduce the reality gap."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Meta-Learning and Learning to Learn"}),": Training agents in simulation to quickly adapt to new, unseen domains (including the real world) with minimal real-world experience."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"real-world-rl-for-humanoid-robots",children:"Real-World RL for Humanoid Robots"}),"\n",(0,o.jsx)(n.p,{children:"Applying RL to humanoid robots brings additional complexities due to their high degrees of freedom, bipedal instability, and complex interactions with the environment. However, recent breakthroughs demonstrate significant promise."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Locomotion"}),": RL has been successfully used to train humanoids to walk, run, jump, and climb stairs in simulation, with impressive Sim-to-Real transfer to platforms like Digit and Cassie. Policies can learn highly dynamic and robust gaits that are difficult to hand-engineer."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Manipulation"}),": RL enables humanoids to learn dexterous manipulation skills, from grasping novel objects to performing complex assembly tasks. Combining vision-based RL with force feedback is crucial here."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Whole-Body Control Integration"}),": RL can be integrated with classical whole-body control frameworks. For example, a high-level RL policy might decide on footstep placements, while a lower-level WBC handles the joint torques to execute the motion and maintain balance."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Human-Robot Interaction"}),": RL is being explored for learning natural and safe interaction behaviors, where the robot learns to respond appropriately to human gestures, commands, and physical cues."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"conclusion-autonomous-skill-acquisition",children:"Conclusion: Autonomous Skill Acquisition"}),"\n",(0,o.jsx)(n.p,{children:"Reinforcement learning provides a compelling pathway for physical AI systems to acquire complex skills autonomously, learning through direct interaction and feedback. While challenges remain, particularly in sample efficiency and safe real-world exploration, advances in Sim-to-Real transfer techniques like domain randomization are rapidly bridging the gap between theory and practical application."}),"\n",(0,o.jsx)(n.p,{children:"The ability to train robots in simulation and deploy robust policies to the real world is unlocking unprecedented capabilities for humanoids and other embodied agents. As RL algorithms become more sample-efficient and simulators more accurate, we can expect to see increasingly versatile and intelligent physical AI systems capable of learning and adapting to the dynamic complexities of our world, moving beyond pre-programmed behaviors to truly autonomous skill acquisition."}),"\n",(0,o.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,o.jsx)(n.p,{children:"Answer the following questions, providing detailed explanations and examples:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"RL Fundamentals (10 points)"}),": Define the core components of a Reinforcement Learning problem: agent, environment, state, action, reward, and policy. Explain the difference between model-free and model-based RL approaches."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Challenges of Real-World RL (10 points)"}),": Identify and elaborate on three significant challenges when applying Reinforcement Learning directly to physical robots, as opposed to simulations. How do these challenges impact the feasibility and safety of real-world robot learning?"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Domain Randomization (10 points)"}),': Explain the concept of Domain Randomization (DR) in Sim-to-Real transfer. How does DR help bridge the "reality gap"? Provide specific examples of parameters that might be randomized during training for a humanoid robot learning to walk.']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Sim-to-Real Techniques (10 points)"}),": Beyond Domain Randomization, describe two other techniques used to facilitate Sim-to-Real transfer for robotic policies. Discuss their underlying principles and how they contribute to successful deployment."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"RL in Humanoid Robotics (10 points)"}),": Describe how Reinforcement Learning is being applied to solve two distinct challenges in humanoid robotics (e.g., locomotion, manipulation, human-robot interaction). How does RL offer advantages over traditional control methods in these areas?"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Sutton, Richard S., and Andrew G. Barto. ",(0,o.jsx)(n.em,{children:"Reinforcement Learning: An Introduction"}),". MIT Press, 2018."]}),"\n",(0,o.jsxs)(n.li,{children:['Watter, Manuel, et al. "Learning for control with high-dimensional state and action spaces." ',(0,o.jsx)(n.em,{children:"Advances in neural information processing systems"})," 27 (2014)."]}),"\n",(0,o.jsxs)(n.li,{children:['Tobin, Josh, et al. "Domain randomization for transferring deep neural networks from simulation to the real world." ',(0,o.jsx)(n.em,{children:"2017 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)"}),". IEEE, 2017."]}),"\n",(0,o.jsx)(n.li,{children:"Publications from Google Brain Robotics, OpenAI, DeepMind, and NVIDIA on sim-to-real, domain randomization, and real-world RL."}),"\n",(0,o.jsx)(n.li,{children:"Relevant chapters from textbooks on robot learning and control."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);